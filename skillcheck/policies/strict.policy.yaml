# Strict policy for hardened production releases.
pack: strict
version: 2
limits:
  skill_name_max: 48
  skill_description_max: 512
  skill_compatibility_max: 250
  skill_body_max_lines: 300

frontmatter:
  allow_unknown_fields: false
  legacy_fields: []

allow:
  network:
    hosts: []
  filesystem:
    read_globs:
      - "SKILL.md"
      - "skill.md"
      - "*.md"
      - "*.yaml"
      - "*.yml"
      - "*.json"
      - "*.toml"
      - "**/*.md"
      - "references/**"
      - "assets/**"
    write_globs:
      - "scratch/**"
  tools:
    allowlist: []

dependencies:
  allow_pypi: []
  allow_npm: []

probe:
  enable_exec: true
  exec_globs:
    - "scripts/**/*.py"
    - "*.py"
  timeout: 5

forbidden_patterns:
  - pattern: "(?i)api[_-]?key|secret|token\\s*[:=]"
    reason: "Potential secret detected in SKILL.md or resources"
  - pattern: "curl\\s+http"
    reason: "Raw network call via curl (HTTP/HTTPS) is forbidden without allowlist"
  - pattern: "requests\\.(get|post|put|delete|patch)\\("
    reason: "Python requests network calls are forbidden without allowlist"
  - pattern: "urllib\\.request\\.urlopen\\("
    reason: "Python network call via urllib.request is forbidden without allowlist"
  - pattern: "subprocess\\.(Popen|run)\\("
    reason: "Shelling out is restricted; must be explicitly allowed by policy"

waivers: []
